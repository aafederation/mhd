{{ $pages := .Site.RegularPages }}

<!--DATA SOURCES-->
{{ $boroughs := $.Site.Data.Boroughs }}
{{ $clinical_services := (index $.Site.Data "Mental health services").Items }}
{{ $psychotherapy_specialties := (index $.Site.Data "Psychotherapy specialties").Items }}
{{ $psychotherapy_types := (index $.Site.Data "Psychotherapy types").Items }}
{{ $languages := $.Site.Data.Languages.Items }}
<!--TAXONOMY COUNTS-->
{{ $tags := $.Site.Taxonomies.tags.ByCount }}
{{ $payments := $.Site.Taxonomies.payment_types.ByCount }}

<!--TAXONOMY NO COUNT VAR-->
{{ $.Scratch.Set "untagged" 0 }}
{{ $.Scratch.Set "noPayments" 0 }}

<!--TAXONOMY NO COUNT COUNTING-->
{{ range $pages }}
	{{ with .Params.tags }}{{ else }}{{ $.Scratch.Add "untagged" 1 }}{{ end }}
	{{ with .Params.payment_types }}
		{{ else }}{{ $.Scratch.Add "noPayments" 1 }}{{ end }}

{{ end }}

{{ partial "filter-data.html" (dict "title" "service" "filter" "service" "allContent" $clinical_services ) }}
<div class="display-none" id="psychotherapy-options">
	{{ partial "filter-data.html" (dict "title" "psychotherapy specialty" "filter" "specialty" "allContent" $psychotherapy_specialties ) }}
	{{ partial "filter-data.html" (dict "title" "psychotherapy type"  "filter" "type" "allContent" $psychotherapy_types ) }}
</div>
{{ partial "filter-taxonomy.html" (dict "filter" "tag" "noCount" ($.Scratch.Get "untagged") "allContent" $tags ) }}
{{ partial "filter-data.html" (dict "title" "borough" "filter" "borough" "allContent" $boroughs ) }}
{{ partial "filter-data.html" (dict "title" "language" "filter" "language" "allContent" $languages ) }}
{{ partial "filter-taxonomy.html" (dict "filter" "payment" "noCount" ($.Scratch.Get "noPayments") "allContent" $payments ) }}
