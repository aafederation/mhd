{{ $borough := index .location.boroughs 0 }}
{{ $showPlace := true }}
{{ $latLng := "" }}
{{ $mappingAddress := "" }}

{{ if ne .location.latLng "" }}
	{{ $latLng = .location.latLng }}
	{{ if or (in (slice "Citywide" "") $borough) (eq $borough nil) }}
		{{ $borough = "New York City" }}
	{{ end }}
	{{ $mappingAddress = print .org.org "," .location.address "," $borough "+NY" }}
	{{ $mappingAddress = replace $mappingAddress "\n" "+" }}
	{{ $mappingAddress = replace $mappingAddress " " "+" }}
{{ else }}
	{{ $latLng = site.Params.defaultLatLng }}
	{{ $showPlace = false }}
{{ end }}

<div class="[ wrapper ] [ bg-primary pad-top-500 color-white ]">
	<h1>{{ .org.org }}</h1>
</div>
<div class="[ wrapper ] [ bg-primary pad-top-500 pad-bottom-500 color-white ]">
	<div class="[ split-pair ] [ text-400 ]">
		<h3>
			<span class="font_icons">&#xe01d;</span>
			<span class="weight-bold">
				{{ .location.address }}
			</span>
		</h3>
		<h3>
			{{ with .location.boroughs }}
				<span class="font_icons">&#xe01f;</span>
				<span class="weight-bold">
					{{ index . 0 }}
				</span>
			{{ end }}
		</h3>
		<h3>
			{{ with .location.phone_number }}
				<span class="font_icons">&#xe090;</span>
				<span class="weight-bold">
					{{ . }}
				</span>
			{{ end }}
		</h3>
	</div>
</div>
<div class="[ wrapper ] [ bg-light pad-top-500 pad-bottom-500 ]">
	<div class="tiles" data-variant="two-per-row">
		<div class="[ bg-white box-shadow-glow ]">
			{{ if ne .org.image "" }}
				<div class="[ ]">
					<h4
						class="underline pad-left-300 pad-right-300 pad-top-300 pad-bottom-300"
					>
						{{ .org.org }}
					</h4>
					<img src="{{ .org.image }}" class="[ bg-white box-shadow-glow ]" alt="">
				</div>
			{{ end }}
			<div class="[ ]">
				<h4
					class="underline pad-left-300 pad-right-300 pad-top-300 pad-bottom-300"
				>
					Location
				</h4>
				<iframe
					frameborder="0"
					width="100%"
					height="300px"
					style="border:0"
					{{ if eq $showPlace true }}
						src="https://www.google.com/maps/embed/v1/place?q={{ $mappingAddress }}&center={{ $latLng }}&key=AIzaSyBq3mhYmZFPmQqp0q0koUSMbTtA49zjwQY&zoom=12&"
					{{ else }}
						src="https://www.google.com/maps/embed/v1/view?center={{ $latLng }}&key=AIzaSyBq3mhYmZFPmQqp0q0koUSMbTtA49zjwQY&zoom=11&"
					{{ end }}
					allowfullscreen
				></iframe>
				{{ if eq $showPlace true }}
					<div class="pad-left-300 pad-right-300 pad-top-300 pad-bottom-300">
						<a
							href="https://www.google.com/maps/dir/?api=1&destination={{ $mappingAddress }}"
							target="_blank"
							rel="noopener noreferrer"
							class="link-pointer color-white bg-primary no-decoration"
						>
							<span class="font_icons">&#xe03c;</span>
							<span class="weight-bold">Get directions</span>
						</a>
					</div>
				{{ end }}
			</div>
		</div>
		<div class="[ bg-white box-shadow-glow ]">
			<h4
				class="underline pad-left-300 pad-right-300 pad-top-300 pad-bottom-300"
			>
				Provider Overview
			</h4>
			<div
				class="flow pad-top-300 pad-right-300 pad-bottom-500 pad-left-300"
				style="--flow-space:0.5rem"
			>
				{{ with .location.phone_number }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#xe090;</span
						>
						<span>{{ . }}</span>
					</div>
				{{ end }}
				{{ with .org.email }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#xe010;</span
						>
						<a
							href="mailto: {{ . }}"
							class="link-pointer"
							data-variant="invert"
							target="_blank"
						>
							{{ . }}
						</a>
					</div>
				{{ end }}
				{{ with .org.website }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#xe0e3;</span
						>
						<a
							href="{{ if not (hasPrefix (lower .) `http`) }}//{{ . }}{{ else }}{{ . }}{{ end }}"
							class="link-pointer handle-long-url"
							data-variant="invert"
							target="_blank"
							>{{ . }}
						</a>
					</div>
				{{ end }}
				{{ with .location.hours_of_operation }}
					<div class="display-flex">
						<span
							class="[ font_icons color-secondary ] [ position-icon ] icon_clock"
							>&#xe06b;</span
						>
						<div class="no-bullets">
							{{ range . }}
								{{ range $key, $value := . }}
									<li>{{ $value }}</li>
								{{ end }}
							{{ end }}
						</div>
					</div>
				{{ end }}
				{{ with .location.services }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#x4e;</span
						>
						<div>
							<span class="weight-bold">{{ partial "functions/forestryLabel" "locations.services" }}: </span>
							<span>
								{{ delimit . ", " }}
							</span>
						</div>
					</div>
				{{ end }}
				{{ with .location.non_clinical_services }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#x4e;</span
						>
						<div>
							<span class="weight-bold">{{ partial "functions/forestryLabel" "locations.non_clinical_services" }}: </span>
							<span>
								{{ delimit . ", " }}
							</span>
						</div>
					</div>
				{{ end }}
				{{ with .content }}
					<div class="display-flex">
						<span class="[ font_icons color-secondary ] [ position-icon ]"
							>&#x4e;</span
						>
						<div>
							{{ . }}
						</div>
					</div>
				{{ end }}
			</div>
		</div>
	</div>
</div>
